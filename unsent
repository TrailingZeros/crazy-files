#!/usr/bin/env groovy
final maxScore=1024*1024*1024

def videos=new File('.')
def anyway=new File('./anyway')

def toPut = (videos.listFiles().findAll {
    "$it".matches(~'.+\\.(?:web[mp]|m(?:p[34]|[ko]v|4[av])|flv|(?:pn|jp)g|gif|og[gva]|wav|aac|zip|7z|t(?:ar(?:\\.gz)?|gz))(?:\\.[0-9]+\\.split)?$')
}+(anyway.listFiles()?:[]).toList()).sort{a,b->
  return b.length()<=>a.length()
}

if(!toPut){
    System.exit(1)
    return
}

def totalPutSize=toPut.inject(0){r,a->r+a.length()}
println "totalPutSize: $totalPutSize"
def estimatedRepoCount=totalPutSize/maxScore
println "estimatedRepoCount: $estimatedRepoCount"
